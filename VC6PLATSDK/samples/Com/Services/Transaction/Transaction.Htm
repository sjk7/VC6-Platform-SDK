<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./Transaction_files/filelist.xml">
<link rel=Edit-Time-Data href="./Transaction_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Transactions</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Eric Adams</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>Eric Adams</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>15</o:TotalTime>
  <o:Created>1999-06-04T03:12:00Z</o:Created>
  <o:LastSaved>1999-06-04T03:12:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>380</o:Words>
  <o:Characters>2167</o:Characters>
  <o:Company>Microsoft Corp.</o:Company>
  <o:Lines>18</o:Lines>
  <o:Paragraphs>4</o:Paragraphs>
  <o:CharactersWithSpaces>2661</o:CharactersWithSpaces>
  <o:Version>9.2720</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<link rel=Stylesheet type="text/css" media=all href="..\..\styles.css">
<style>
<!--
a:visited
	{color: 336666;}
A:hover {background:Olive; color: White}
 /* Font Definitions */
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536871559 0 0 0 415 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
a:link, span.MsoHyperlink
	{mso-ansi-font-size:9.0pt;
	mso-bidi-font-size:9.0pt;
	mso-ascii-font-family:Verdana;
	mso-hansi-font-family:Verdana;
	color:olive;
	mso-text-animation:none;
	mso-hide:none;
	text-decoration:none;
	text-underline:none;
	text-decoration:none;
	text-line-through:none;}
a:visited, span.MsoHyperlinkFollowed
	{mso-ansi-font-size:9.0pt;
	mso-bidi-font-size:9.0pt;
	mso-ascii-font-family:Verdana;
	mso-hansi-font-family:Verdana;
	color:blue;
	mso-text-animation:none;
	mso-hide:none;
	text-decoration:none;
	text-underline:none;
	text-decoration:none;
	text-line-through:none;}
p
	{margin-right:0in;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0in;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
code
	{mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	mso-hide:none;}
kbd
	{mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	mso-hide:none;}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	tab-stops:45.8pt 91.6pt 137.4pt 183.2pt 229.0pt 274.8pt 320.6pt 366.4pt 412.2pt 458.0pt 503.8pt 549.6pt 595.4pt 641.2pt 687.0pt 732.8pt;
	font-size:10.0pt;
	font-family:"Courier New";
	mso-fareast-font-family:"Courier New";}
samp
	{mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	mso-hide:none;}
tt
	{mso-ascii-font-family:"Courier New";
	mso-fareast-font-family:"Courier New";
	mso-hansi-font-family:"Courier New";
	mso-bidi-font-family:"Courier New";
	mso-hide:none;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:196814632;
	mso-list-type:hybrid;
	mso-list-template-ids:-1591680958 -906827834 955001428 679402700 492852882 -1345679658 877288064 914292540 693660336 1494764988;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
</head>

<body lang=EN-US link=olive vlink=blue style='tab-interval:.5in'>

<div class=Section1>

<h2><span style='font-family:Verdana;color:black'>Transactions<o:p></o:p></span></h2>


<div class=MsoNormal align=center style='text-align:center'><span
style='font-size:9.0pt;font-family:Verdana;color:black'>

<hr size=2 width="100%" align=center>

</span></div>


<h4><span style='font-family:Verdana;color:black'>Overview<o:p></o:p></span></h4>

<p><span style='font-size:9.0pt;font-family:Verdana;color:black'>COM+ provides
a variety of samples that demonstrate how to build components that participate
in transactions and that use different data access methods. COM+ transaction
services simplify the task of developing application components by allowing you
to perform work with transactions. This protects applications from anomalies
caused by concurrent updates or system failures. Transactions maintain the ACID
properties: <o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.0in;text-indent:-.25in;mso-list:l0 level1 lfo2;tab-stops:list .5in'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:9.0pt;font-family:Symbol;color:black'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><b><span style='font-size:9.0pt;font-family:Verdana;
color:black'>A</span></b><span style='font-size:9.0pt;font-family:Verdana;
color:black'>tomicity ensures that all the updates completed under a specific
transaction are committed and made durable, or that they get aborted and rolled
back to their previous state. <o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.0in;text-indent:-.25in;mso-list:l0 level1 lfo2;tab-stops:list .5in'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:9.0pt;font-family:Symbol;color:black'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><b><span style='font-size:9.0pt;font-family:Verdana;
color:black'>C</span></b><span style='font-size:9.0pt;font-family:Verdana;
color:black'>onsistency means that a transaction is a correct transformation of
the system state, preserving the state invariants. <o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.0in;text-indent:-.25in;mso-list:l0 level1 lfo2;tab-stops:list .5in'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:9.0pt;font-family:Symbol;color:black'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><b><span style='font-size:9.0pt;font-family:Verdana;
color:black'>I</span></b><span style='font-size:9.0pt;font-family:Verdana;
color:black'>solation protects concurrent transactions from seeing each other's
partial and uncommitted results, which might create inconsistencies in the
application state. Resource managers use transaction-based synchronization
protocols to isolate the uncommitted work of active transactions. <o:p></o:p></span></p>

<p class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:1.0in;text-indent:-.25in;mso-list:l0 level1 lfo2;tab-stops:list .5in'><![if !supportLists]><span
style='font-size:10.0pt;mso-bidi-font-size:9.0pt;font-family:Symbol;color:black'>·<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><![endif]><b><span style='font-size:9.0pt;font-family:Verdana;
color:black'>D</span></b><span style='font-size:9.0pt;font-family:Verdana;
color:black'>urability means that committed updates to managed resources, such
as a database record, survive failures, including communication failures,
process failures, and server system failures. Transactional logging even allows
you to recover the durable state after disk media failures. <o:p></o:p></span></p>

<p><span style='font-size:9.0pt;font-family:Verdana;color:black'>The
intermediate states of a transaction are not visible outside the transaction,
and either all the work happens or none of it does. You can develop
application components as if each transaction executes sequentially and without
regard to concurrency. This is a tremendous simplification for application
developers.<o:p></o:p></span></p>

<p><span style='font-size:9.0pt;font-family:Verdana;color:black'>You can
declare that a component is transactional, in which case COM+ associates transactions
with the component's objects. When an object's method is executed, the services
that resource managers and resource dispensers perform on its behalf execute
under a transaction. This can also include work that it performs for other COM+ objects. Work from multiple objects can be composed into a single
atomic transaction. <o:p></o:p></span></p>

<h4><span style='font-family:Verdana;color:black'>Project Files<o:p></o:p></span></h4>

<table border=0 cellpadding=0 width="75%" style='width:75.0%;mso-cellspacing:
 1.5pt;mso-padding-alt:0in 0in 0in 0in'>
 <tr>
  <td width="25%" valign=top style='width:25.8%;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><strong><span style='font-size:9.0pt;font-family:Verdana;
  color:black'>Subdirectory</span></strong><span style='font-size:9.0pt;
  font-family:Verdana;color:black'><o:p></o:p></span></p>
  </td>
  <td width="73%" valign=top style='width:73.4%;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><strong><span style='font-size:9.0pt;font-family:Verdana;
  color:black'>Description</span></strong><span style='font-size:9.0pt;
  font-family:Verdana;color:black'><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="25%" valign=top style='width:25.8%;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span style='font-size:9.0pt;font-family:Verdana;
  color:black'>SampleBank<o:p></o:p></span></p>
  </td>
  <td width="73%" valign=top style='width:73.4%;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span style='font-size:9.0pt;font-family:Verdana;
  color:black'>Sample Bank application that demonstrates components that participate
  in transactions. For more information on this sample, see <a
  href="SampleBank\Sample%20Bank.htm"><span style='font-size:12.0pt;font-family:
  "Times New Roman"'>Sample Bank.htm</span></a><o:p></o:p></span></p>
  </td>
 </tr>
 <tr>
  <td width="25%" valign=top style='width:25.8%;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span style='font-size:9.0pt;font-family:Verdana;
  color:black'>DataAccess<o:p></o:p></span></p>
  </td>
  <td width="73%" valign=top style='width:73.4%;padding:.75pt .75pt .75pt .75pt'>
  <p class=MsoNormal><span style='font-size:9.0pt;font-family:Verdana;
  color:black'>Demonstrates how to use ADO, RDO, OLE DB and ATL in a COM+ application.
  A simple COM+ component obtains a first name from SQL Server's pubs database
  and returns this name to the client.<span style="mso-spacerun: yes"> 
  </span>For more information on this sample, see <a
  href="DataAccess\DataAccess.htm">DataAccess.htm</a><o:p></o:p></span></p>
  </td>
 </tr>
</table>

<h4><span style='font-family:Verdana;color:black'>Build Notes<o:p></o:p></span></h4>

<p><b>To build the Transaction Sample</b>
<ol>
<li>Open the Transaction.dsw workspace from Visual C++, set ADOKB Classes to be the Active Project.
<li>In ADOComponent.cpp, modify the path of Msado20.tlb to reflect its actual location, and select <B>Build/Rebuild All</b> on the menus.<small><br><I> You can also use the Microsoft NMAKE-compatible makefile (MAKEFILE).</I></small></ol>
<br><br>
<p><b>To build the Bank Sample</b>
<p>See the <a href="SampleBank\Sample Bank.htm">Bank Sample Instructions</a><br>

<p><span style='font-size:9.0pt;font-family:Verdana;color:black'>&nbsp;<o:p></o:p></span></p>

<p><span style='font-size:9.0pt;font-family:Verdana;color:black'>&nbsp;<o:p></o:p></span></p>

<p><span style='font-size:9.0pt;font-family:Verdana;color:black'>&nbsp;<o:p></o:p></span></p>


<div class=MsoNormal align=center style='text-align:center'><span
style='font-size:9.0pt;font-family:Verdana;color:black'>

<hr size=2 width="100%" align=center>

</span></div>


<p><span style='font-size:9.0pt;font-family:Verdana;color:black'>&nbsp;<o:p></o:p></span></p>

</div>

</body>

</html>
